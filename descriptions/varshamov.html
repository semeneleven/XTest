
<p align=center><font size=5><i>Код Варшамова. Краткие теоретические сведения.</i></font></p>
<p align=center><font size=4>Введение</font></p>
<p><br>&nbsp;&nbsp;&nbsp; Код предложенный Варшамовым является типичным представителем систематических кодов, т.е. сумма любых разрешенных комбинаций также является разрешенной комбинацией. Благодаря этому возможно построить все комбинации кода, располагая лишь их ограниченным количеством. Построение систематического кода производится на основе образующей матрицы. Образующую матрицу можно представить в виде двух подматриц: информационной | E<sub>k</sub> | ( единичная матрица, k – количество информационных элементов ) и проверочной | C<sub>rk</sub> |.</p>
<p align=center><font size=4>Построение матриц G и Н</font></p>
<p>&nbsp;&nbsp;&nbsp; Проверочная матрица | C<sub>rk</sub> | для кода Варшамова строится подбором различных комбинаций и должна удовлетворять следующим условиям:</p>
<ol>
<li><p>Каждая строка подматрицы | C<sub>rk</sub> | должна содержать не менее d - 1 единиц (d – минимальное кодовое расстояние);</li>
<li><p>Сумма любых j-строк должно иметь не менее d-j единиц;</li>
<li><p>Число столбцов в подматрице ( r – число проверочных элементов )</p>
    <p align=center><img src="Warsha2.gif"></p>
    <p>где n – длина кодовой комбинации.</p>
    <p align=center><img src="Warsha3.gif"></p>
</li>
</ol>
<p>&nbsp;&nbsp;&nbsp; Код Варшамова, как и любой другой систематический код, способен обнаруживать и исправлять ошибки. Количество исправляемых ошибок:</p>
<p align=center><img src="Warsha4.gif"></p>
<p>&nbsp;&nbsp;&nbsp;<i>t<sub>u</sub></i> – целое число, т.е. в (3) округляется до ближайшего меньшего целого.</p>
<p>&nbsp;&nbsp;&nbsp; Для того, чтобы обнаружить в каком разряде была допущена ошибка, строят проверочную матрицу Н. Проверочная матрица состоит из двух подматриц: | D<sub>kr</sub> |, содержащая k-столбцов и r-строк и | E<sub>r</sub> | – единичная матрица..Каждая строка | D<sub>kr</sub> | соответствует столбцу проверочных разрядов подматрицы | C<sub>rk</sub> | образующей матрицы G.</p>
<p align=center><font size=4>Общий вид матриц G и H (пример).</font></p>
<blockquote>
  <p align=center><img src="Warsha5.gif"></p>
  <p align=center><img src="Warsha6.gif"></p>
</blockquote>
<p align=center><img src="Warsha7.gif"></p>
<p align=center><font size=4>Кодирование.</font></p>
<p>&nbsp;&nbsp;&nbsp; Кодирование рассмотрим на примере.</p>
<ol>
  <li><p>Кодирование с помощью матрицы G.<br>Закодируем 101. Для этого, как видно из матрицы G, необходимо сложить первую и третью строки по модулю 2. Получим<br>1 0 1 (a1 xor c1) (a2 xor c2 ).</p></li>
  <li><p>Кодирование с помощью матрицы H</p>
      <p align=center><img src="Warsha6.gif"></p>
      <p>Закодируем 011. Для этого поступим следующим образом:
    <ol>
      <li><p>Вычислим первый проверочный элемент b<sub>1</sub>=(0 &amp; a<sub>1</sub>) xor (1 &amp; b<sub>1</sub>) xor (1 &amp; c<sub>1</sub>).</p></li>
      <li><p>Вычислим второй проверочный элемент b<sub>2</sub>=(0 &amp; a<sub>2</sub>) xor (1 &amp; b<sub>2</sub>) xor (1 &amp; c<sub>2</sub>).</p></li>
      <li><p>Запишем код 0 1 1 b<sub>1</sub> b<sub>2</sub>.</p></li>
    </ol>
  </li>
</ol>
<p align=center><font size=4>Обнаружение ошибок.</font></p>
<p>&nbsp;&nbsp;&nbsp; При использовании проверочной матрицы Н для обнаружения ошибки проверка кодовой комбинации на приемной стороне осуществляется при помощи т.н. КОДОВЫХ СИНДРОМОВ (S) которые вычисляются следующим образом:</p>
<p align=center><img src="Warsha6.gif"></p>
<p>Код: e<sub>1</sub> e<sub>2</sub> e<sub>3</sub> b<sub>1</sub> b<sub>2</sub><br>
S1=(e<sub>1</sub> &amp; a<sub>1</sub>) xor (e<sub>2</sub> &amp; b<sub>1</sub>) xor (e<sub>3</sub> &amp; c<sub>1</sub>) xor b<sub>1</sub><br> S2=(e<sub>1</sub> &amp; a<sub>2</sub>) xor (e<sub>2</sub> &amp; b<sub>2</sub>) xor (e<sub>3</sub> &amp; c<sub>2</sub>) xor b<sub>2</sub><br><br>где e<sub>1</sub>...c<sub>2</sub>  – элементы матрицы H.<br>
&nbsp;&nbsp;&nbsp; Между комбинацией синдрома и вызвавшей его комбинацией ошибки нет взаимно однозначного соответствия. Поэтому за каждым синдромом закрепляется такая исправляемая ошибка, появление которой в канале связи наиболее вероятно.</p>
<p align=center><font size=4>Образец работы</font></p>
<p>Пусть длина кодовой комбинации n = 7 и минимальное кодовое расстояние d = 3.</p>
<ol>
  <li><p>Количество столбцов G равно 7.</p></li>
  <li><p>Количество исправляемых таким кодом ошибок<br><img src="Warsha8.gif"></li>
  <li><p>Количество строк G равно k=n-r; из (1) найдем r:<br><img src="Warsha9.gif"><br>Отсюда </span>k = 7 - 3 = 4.</p></li>
  <li><p>Построим производящую матрицу G и проверочную Н.</p>
      <p>G:</p>
      <table border=1 width=200>
      <tr align=center>
        <td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td>
      </tr>
      <tr align=center>
        <td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td>
      </tr>
      <tr align=center>
        <td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td>
      </tr>
      <tr align=center>
        <td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td>
      </tr>
      </table>
      <p>H:</p>
      <table border=1 width=200>
      <tr align=center>
        <td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td>
      </tr>
      <tr align=center>
        <td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td>
      </tr>
      <tr align=center>
        <td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td>
      </tr>
      </table>
      <p></p></li>
  <li><p>Кодирование при помощи G<br>Число: 1100<br>Код: 1100 110 (1-я строка xor 2-я строка)<br><br>Число: 1010<br>Код: 1010 101 (2-я строка xor 4-я строка)<br><br>Число: 0110<br>Код: 0110 011 (3-я строка xor 4-я строка)</p></li>
  <li><p>Обнаружение ошибки.
    <ol>
      <li><p>Вычислим синдромы для кода с ошибкой в первом разряде:<br>Код: <b>1</b>100 110<br>Kод с ошибкой:<b>0</b>100 110<br><br>S1 = (0 &amp; 0) xor (1 &amp; 1) xor (0 &amp; 1) xor (0 &amp; 1) xor 1=0<br>S2 = (0 &amp; 1) xor (1 &amp; 0) xor (0 &amp; 1) xor (0 &amp; 1) xor 1=1<br>S3 = (0 &amp; 1) xor (1 &amp; 1) xor (0 &amp; 0) xor (0 &amp; 0) xor 0=1.</p></li>
      <li><p>Аналогично вычислив синдромы и для кодов с ошибками в других разрядах, получим таблицу:</p>
        <table border=1 width=450>
        <tr align=center>
          <td>Номер искаженного разряда</td>
          <td>Синдром</td>
        </tr>
        <tr align=center>
          <td>1</td><td>0 1 1</td>
        </tr>
        <tr align=center>
          <td>2</td><td>1 0 1</td>
        </tr>
        <tr align=center>
          <td>3</td><td>1 1 0</td>
        </tr>
        <tr align=center>
          <td>4</td><td>1 1 1</td>
        </tr>
        <tr align=center>
          <td>5</td><td>1 0 0</td>
        </tr>
        <tr align=center>
          <td>6</td><td>0 1 0</td>
        </tr>
        <tr align=center>
          <td>7</td><td>0 0 1</td>
        </tr>
        </table>
        <p>Используя эту таблицу, можно по полученному коду, вычислив синдромы, определить номер искаженного разряда.</p>
      </li>
    </ol>
  </li>
</ol>

